<UserControl
	x:Class="FinanceTracker.Views.MainView"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:controls="clr-namespace:Win10Themables.Controls;assembly=Win10Themables"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:vms="clr-namespace:FinanceTracker.Core.ViewModels;assembly=FinanceTracker.Core"
	d:DesignHeight="450"
	d:DesignWidth="800"
	mc:Ignorable="d">
	<UserControl.Resources>
		<DataTemplate x:Key="MenuItemDataTemplate" DataType="{x:Type vms:ViewModelBase}">
			<Grid>
				<StackPanel>
					<Grid>
						<controls:ExtendedButton
							x:Name="Button"
							Width="200"
							Height="40"
							Margin="0"
							VerticalAlignment="Top"
							HorizontalContentAlignment="Left"
							Background="Transparent"
							BorderThickness="0"
							Command="{Binding SelectCommand}"
							Content="{Binding Name}"
							Foreground="{DynamicResource TextBrush}"
							MouseDownColour="{DynamicResource ControlClickablePartMouseDownBrush}"
							MouseOverColour="{DynamicResource ControlClickablePartMouseOverBrush}"
							Padding="{Binding Level, Converter={StaticResource LeftPaddingConverter}, ConverterParameter=15}">
						</controls:ExtendedButton>
						<controls:ExtendedButton
							Width="30"
							Height="30"
							Margin="0"
							Content="+"
							VerticalAlignment="Center"
							VerticalContentAlignment="Center"
							HorizontalContentAlignment="Center"
							Padding="0"
							FontSize="20"
							CornerRadius="3"
							Visibility="{Binding SupportsAddingChildren, Converter={StaticResource VisibleIfTrueConverter}}"
							BorderThickness="0"
							Foreground="{DynamicResource TextBrush}"
							Background="{DynamicResource ControlClickablePartBrush}"
							MouseDownColour="{DynamicResource ControlClickablePartMouseDownBrush}"
							MouseOverColour="{DynamicResource ControlClickablePartMouseOverBrush}">
						</controls:ExtendedButton>
						<Grid
							Width="10"
							Height="10"
							Margin="15,3,15,0"
							HorizontalAlignment="Right"
							IsHitTestVisible="False"
							RenderTransformOrigin="0.5,0.5"
							Visibility="{Binding ChildViewModels, Converter={StaticResource SequenceHasElementsVisibilityConverter}}">
							<Grid.RenderTransform>
								<RotateTransform>
									<RotateTransform.Angle>
										<MultiBinding Converter="{StaticResource ValueIfTrueValueIfFalseConverter}">
											<Binding Path="ShowChildren" />
											<Binding ElementName="RotateGrid" Path="Margin.Left" />
											<Binding ElementName="RotateGrid" Path="Margin.Right" />
										</MultiBinding>
									</RotateTransform.Angle>
								</RotateTransform>
							</Grid.RenderTransform>
							<Line
								Stroke="{DynamicResource TextBrush}"
								StrokeThickness="1"
								X1="0"
								X2="5.1"
								Y1="2.5"
								Y2="7.6" />
							<Line
								Stroke="{DynamicResource TextBrush}"
								StrokeThickness="1"
								X1="4.9"
								X2="10"
								Y1="7.4"
								Y2="2.5" />
						</Grid>
						<Border
							Height="1"
							Margin="7,0"
							VerticalAlignment="Bottom"
							Background="{DynamicResource DisabledControlNonClickablePartBrush}" />
					</Grid>
					<Grid Visibility="{Binding ShowChildren, Converter={StaticResource VisibleIfTrueConverter}}">
						<Grid Background="White" Opacity="0.1" />
						<ItemsControl
							Height="40"
							HorizontalAlignment="Right"
							VerticalAlignment="Bottom"
							ItemTemplate="{DynamicResource MenuItemDataTemplate}"
							ItemsSource="{Binding ChildViewModels}" />
					</Grid>
				</StackPanel>
				<Border
					Height="3"
					Margin="6,0"
					VerticalAlignment="Bottom"
					Background="{DynamicResource ThemeBrush}"
					CornerRadius="1"
					Visibility="{Binding IsSelected, Converter={StaticResource VisibleIfTrueConverter}}" />
				<!--#region Property store hacks-->
				<Grid
					x:Name="RotateGrid"
					Margin="180,0,0,0"
					Visibility="Collapsed" />
				<!--#endregion End property store hacks-->
			</Grid>
		</DataTemplate>
	</UserControl.Resources>
	<Grid>
		<Grid
			Width="140"
			HorizontalAlignment="Left"
			Background="{DynamicResource StatusTextLightBrush}">
			<ItemsControl
				x:Name="ItemsControl"
				Focusable="False"
				ItemTemplate="{StaticResource MenuItemDataTemplate}"
				ItemsSource="{Binding ViewModels}" />
		</Grid>
		<ContentControl
			Margin="140,0,0,0"
			HorizontalAlignment="Left"
			Content="{Binding Path=VisibleViewModel, UpdateSourceTrigger=PropertyChanged}"
			Foreground="{DynamicResource TextBrush}" />
	</Grid>
</UserControl>
